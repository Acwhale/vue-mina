webpackJsonp([4],{"63sk":function(t,s){},MTsq:function(t,s){},TLi4:function(t,s,n){"use strict";Object.defineProperty(s,"__esModule",{value:!0});var a=n("L0tH"),e=n("brQw"),i={render:function(){var t=this.$createElement;return(this._self._c||t)("div",{staticClass:"container"})},staticRenderFns:[]};var o=n("VU/8")({name:"CmpMask"},i,!1,function(t){n("MTsq")},"data-v-867313a6",null).exports,c=n("Fd2+"),l=n("gw/V"),r=n("jWIC"),v=new l.a,u=new r.a,m={name:"BookDetail",components:{CmpTag:a.a,CmpLike:e.a,CmpMask:o},data:function(){return{content:"",comments:[],book:null,likeStatus:!1,likeCount:0,posting:!1}},methods:{handlePost:function(t){var s=this.$route.params.id;this._addComment(s,t)},handlePostInput:function(){var t=this.content,s=this.$route.params.id;0!=t.length?t.length>12?Object(c.c)("短评12个字"):this._addComment(s,t):Object(c.c)("请输入内容")},_addComment:function(t,s){var n=this;u.addComment(t,s).then(function(t){201==t.status&&(n.comments.comments.unshift({content:s,nums:1}),Object(c.c)("+1"),n.posting=!1)})},handleCancel:function(){this.posting=!1},postFake:function(){this.posting=!0},getBookDeatail:function(t){var s=this;u.getBookDeatail(t).then(function(t){200==t.status&&"OK"==t.statusText&&(t=t.data,s.book=t)})},getBookComments:function(t){var s=this;u.getBookComments(t).then(function(t){200==t.status&&"OK"==t.statusText&&(t=t.data,s.comments=t)})},getLikeStatus:function(t){var s=this;u.getLikeStatus(t).then(function(t){200==t.status&&"OK"==t.statusText&&(t=t.data,s.likeCount=t.fav_nums,s.likeStatus=0!=t.like_status)})},handleStatus:function(t){v.like(t,this.book.id,400).then(function(t){console.log(t)})}},computed:{bookSummary:function(){if(!this.book.summary)return"";var t=new RegExp("\\\\n","g");return this.book.summary.replace(t,"<br /> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;")}},mounted:function(){var t=this.$route.params.id;this.getBookDeatail(t),this.getBookComments(t),this.getLikeStatus(t)}},d={render:function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"container ext-content"},[t.book?n("div",{staticClass:"head"},[n("img",{attrs:{src:t.book.image,alt:""}}),t._v(" "),n("span",{staticClass:"title"},[t._v(t._s(t.book.title))]),t._v(" "),n("span",{staticClass:"author"},[t._v(t._s(t.book.author[0]))])]):t._e(),t._v(" "),n("div",{staticClass:"sub-container"},[n("span",{staticClass:"headline"},[t._v("短评")]),t._v(" "),n("span",{directives:[{name:"show",rawName:"v-show",value:0==t.comments.comments,expression:"comments.comments == false"}],staticClass:"shadow"},[t._v("暂无短评")]),t._v(" "),n("div",{staticClass:"comments-container "},t._l(t.comments.comments,function(s,a){return n("div",{key:a},[n("cmp-tag",{staticClass:"ex",attrs:{text:s.content}},[n("span",{staticClass:"num",attrs:{slot:"after"},slot:"after"},[t._v(t._s("+"+s.nums))])])],1)}))]),t._v(" "),t.book?n("div",{staticClass:"sub-container"},[n("span",{staticClass:"headline"},[t._v("内容简介")]),t._v(" "),n("p",{staticClass:"content",domProps:{innerHTML:t._s(t.bookSummary)}})]):t._e(),t._v(" "),n("div",{staticClass:"sub-container"},[n("span",{staticClass:"headline"},[t._v("书本信息")]),t._v(" "),n("div",{staticClass:"detail-contaner"},[t._m(0),t._v(" "),t.book?n("div",{staticClass:"vertical"},[n("div",{},[t._v(t._s(t.book.publisher))]),t._v(" "),n("div",{},[t._v(t._s(t.book.pubdate))]),t._v(" "),n("div",{},[t._v(t._s(t.book.pages))]),t._v(" "),n("div",{},[t._v(t._s(t.book.price))]),t._v(" "),n("div",{},[t._v(t._s(t.book.binding))])]):t._e()])]),t._v(" "),t.posting?t._e():n("div",{staticClass:"post-container"},[n("div",{staticClass:"post-fake",on:{click:t.postFake}},[n("span",[t._v("输入短评")])]),t._v(" "),n("div",{staticClass:"like-container"},[n("cmp-like",{staticClass:"cmplike",attrs:{count:t.likeCount,like:t.likeStatus},on:{status:t.handleStatus}})],1)]),t._v(" "),t.posting?n("div",{staticClass:"posting-container"},[n("div",{staticClass:"post-header"},[0!=t.comments.comments?n("span",[t._v("仅可点击标签+1")]):n("span",[t._v("暂无短评")]),t._v(" "),n("span",{staticClass:"cancel",on:{click:t.handleCancel}},[t._v("取消")])]),t._v(" "),n("div",{staticClass:"comments-container"},t._l(t.comments.comments,function(s,a){return n("div",{key:a},[n("cmp-tag",{staticClass:"ex-tag",attrs:{text:s.content},on:{tag:t.handlePost}},[n("span",{staticClass:"num",attrs:{slot:"after"},slot:"after"},[t._v(t._s("+"+s.nums))])])],1)})),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.content,expression:"content"}],staticClass:"post",attrs:{type:"text",placeholder:"短评最多12个字"},domProps:{value:t.content},on:{click:t.handlePostInput,input:function(s){s.target.composing||(t.content=s.target.value)}}})]):t._e(),t._v(" "),t.posting?n("cmp-mask"):t._e()],1)},staticRenderFns:[function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("div",{staticClass:"vertical"},[n("div",{staticClass:"description"},[t._v("出版社")]),t._v(" "),n("div",{staticClass:"description"},[t._v("出版年")]),t._v(" "),n("div",{staticClass:"description"},[t._v("页数")]),t._v(" "),n("div",{staticClass:"description"},[t._v("定价")]),t._v(" "),n("div",{staticClass:"description"},[t._v("装帧")])])}]};var _=n("VU/8")(m,d,!1,function(t){n("63sk")},"data-v-64a700f9",null);s.default=_.exports},"gw/V":function(t,s,n){"use strict";var a=n("Zrlr"),e=n.n(a),i=n("wxAW"),o=n.n(i),c=n("mtWM"),l=n.n(c),r=function(){function t(){e()(this,t)}return o()(t,[{key:"like",value:function(t,s,n){var a=t?"like":"like/cancel",e={art_id:s,type:n};return l.a.post(a,e)}}]),t}();s.a=r}});
//# sourceMappingURL=4.229c6ef54da773a7a30c.js.map